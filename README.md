# Zoom Enterprise User Support Tool (Zoom ZEUS-Tool)
# NOTE  October 2024
The authentication method used in this program, JWT Tokens, have been deprecated by Zoom for a little while now.  An alternate form of authentication will be needed like the use of OAuth authentication.


# Developer Comments
I will be working on updates to this sporadically throughout 2021 as other projects have my attention, with a couple needs-based updates with user groups and custom user tags/attributes and then I will be focusing on custom presets and bug fixes.   My code is not very object-oriented as well so some fine tuning of code to get it aligned with more modern and Pythonic practices will eventually come.

## Latest Update: December 6th, 2021 Update
- Added ability to pull all recordings for specified user
- Added ability to copy all applicable settings from a group or subaccount into another group in the main account.

# Overview
Standalone Python program that manages deprovisoning or relicensing users in Zoom to basic based on either an email list of users, or their last sign-in date.  It uses the TKinter module to provide a very basic GUI interface.  A code-signed Windows App will be forthcoming, and I may also generate a Mac version once the code moves into a "beta" state.  The program has expanded overtime as a need arose for a new function to be automated.   Some functions may have also been introduced by Zoom over time and in some cases may be quicker to do via Zoom's web interface.

Users need an API Key and API Secret with admin-level access from a JWT Token App in Zoom's marketplace.  The code will generate the JWT Token. 

The program will retrieve all users in account, check against the specified inactive data, and relicense users to Basic if they still have cloud recordings (if checked in the program) or else delete them if they also haven't been active for the specified number of months.  The program will save the user data to file, so it can be opened by the program again later.

As an option, the email list is just a list of email addresses of users with a header at the top of the csv file (i.e. Emails) that will be used to delete users from Zoom  en masse

Ultimately this is an interim tool for Zoom enterprise/business users that don't have a full user provisioning workflow in place and need to free up licenses.

# Basic Instructions
1. At a minimum you will need to populate the API Key and API Secret pulled from a Zoom JWT app
2. Select "Retrieve All Users" to initiate the building of a local file of all users in Zoom account associated with JWT Token (Excludes subaccounts currently)
3. Most other functionality in app requires step 2 to be completed.

Notes:  If processing of any function takes too long, you can select the "Cancel Action" button.  

# What big feature doesn't work yet
- Currently the LDAP feature is not yet functional, but some basic coding for LDAP connectivity and attribute retrieval does exist in the code.
- Custom API presets are not yet functional


# Bugs:
This is a functional alpha release and will license and delete users from your Zoom account.  There are bugs with re-opening the saved user file generated by the program, but that will be addressed soon.

-Backing up user settings can take a long time for large accounts (can be 7 hours).  At this time the program may freeze if between 1000-4000 user settings are backed up.   The CSV file will be generated, and if you want to continue backing up users from where it left off, you can enter the last email address listed in the CSV file under the "Restart Processing" frame.  The issue lies with the use of the TKinter GUI module and certain calls, so multi-threading will be introduced in the future to alleviate the issue.
-Will be addressing areas that list UTC time to display in local timezone.

# Considerations
The program will retrieve a single user in multiple Zoom groups, but at this time any other functionality that processes group information will only look at one group.

# GUI
![Alt text](https://github.com/mkumar-avit/zoom-mass-de-provisioning/blob/master/Zoom%20Zeus.png?raw=true "Current GUI")
![Alt text](https://github.com/mkumar-avit/zoom-mass-de-provisioning/blob/master/Zoom%20Zeus%20log%20config.png?raw=true "user inteface - log configuration settings.")

# Requirements
User can now have a lower resolution to comfortably view the entire program GUI.  Future updates are still being planned for the GUI.


# Files Generated by Program
The program will generate multiple files, based on your choice of actions in the same folder as the program:
- A log file of all the contents of the log window, if the log window is cleared, and new log file will be started
- User Setting Tracking.csv - backup of user settings (can be used to generate pivot tables to see how many users made certain setting changes)
- Zoom Group Setting Tracking.csv - backup of all the groups setting in the account
 -Zoom Retrieved User List.csv - backup of retrieve user data from Zoom, can be used as a basis to generate an update list that can be imported into the Zoom webportal
 
#Button Functionality
## Settings

### ACTION MENU ITEMS

#### Open Credentials file
(optional) Open a CSV file that contains the API Key, API Secret, Domain, LDAP Host LDAP Login, and LDAP Password.  This is not a recommended method since this is pulling data from a cleartext source.   May investigate alternatives in the future like LastPass integration.

#### Account Info
A quick way to test if the API Key and Secret are valid, should pull cloud storage and available license info and populate the status bar with the information.

#### List Zoom User Roles
Pulls zoom user roles and populates the User Level section roles drop down menu with the roles in the account 

### FUNCTIONS
### Zoom Communication Settings
#### API Key
API Key pulled from Zoom JWT app in Zoom Marketplace.  Will need account-level access (admin user typically or account owner)

#### API Secret
API Secret pulled from Zoom JWT app in Zoom Marketplace.  Will need account-level access (admin user typically or account owner)

### Auto-Fill Settings
#### Email Domain
(optional) Enter your organization's domain, and and entries that are clicked in the log window that contain the domain will automatically populate the User Email field

### LDAP Settings
#### LDAP Host
Currently not used
#### LDAP Login
Currently not used
#### LDAP Password
Currently not used

### File Management
#### Default Save Folder
Lists the path where all log files and content are stored

#### Recordings Metadata
Displays a popup with a list of files located in the default save folder path that contain previously pulled recording metadata


### Logging Options
#### Timestamp
Display timestamp in logging window and save with logs
#### Wrap Lines
Wrap log text in window and log file for better readability
#### Display Inactive Users
When scanning users, display users in log that are considered inactive
#### Display Users in No Groups
When scanning users, display users in log that are not associated with any Zoom Group
#### Save Logs
Automatically save logs to a timestamped file in the default folder path
#### Click Line to Copy
Selecting and highlighting black a line in the log will save the contents to the clipboard
#### Debug Mode
Display extended error messages and raw, parsed data responses from Zoom
##### Testing Mode
Prevent actions from triggering commands to Zoom


## Account Level 
### ACTION MENU ITEMS

#### Retrieve all user data
Retrieve all user data from Zoom

#### Open all user data
Open an existing file of previously retrieved user data (*Currently not functional)

#### Modify/Delete Users via CSV email list file
Open a CSV of just email addresses (can have a header) for license modification or deletion

#### Modify/Delete inactive users to Basic
Based on the inactivity data and other settings modify the active list of users' licenses in bulk

#### Backup user settings
Backup all user account settings to CSV, depending on the number of users in account this may take
a long time to complete

#### Update Custom Attribute for all filtered Users
Update the value of a custom attribute for the filtered user

#### Get all acct Recording Metadata
Pull all account recording metadata for the month specified as the starting date, and then up to X number of months previous to that month based on the number of months entered

### Options that prevent user updates (user filtering)
#### Limit To
Filters/Limits updates to users based on group (or no group)

#### Change user to Basic (No Deletes)
Checkbox will toggle to allow user deletes (when off), or update user to "Basic" license type (when on).  Button text will update in Action buttons that are applicable
#### Check for Upcoming Meetings
Checkbox will toggle checking if a user has an upcoming scheduled meeting in zoom, and prevent the user from being deleted/updated.   Button text will update in Action buttons that are applicable
#### Check for Cloud Recordings
Checkbox, that when enabled will prevent users within the prescribed timeframe that have cloud recordings from having their license modified in bulk processing
#### Check for User Activity
Checkbox, that when enabled will prevent users within the prescribed timeframe of last activity from having their acccount/license modified in bulk processing
#### No. of Months to Check for Recordings
Defaults to 6.  Number of months to review a users account for cloud recordings, the counting goes backward based on the starting date specified when searching metadata in the next field or for the current date when looking at modifying licenses.
#### Date to Start Checking Recordings (YYYY-MM)
Date to start checking recordings when reviewing cloud recording metadata in the format of  YEAR-MONTH
#### Months to be considered still active
Number of months a user needs to have activity (i.e. in a meeting) before the program flags the user as inactive (this is being deprecated and functionality is not guaranteed)
#### Date of last login for an inactive user (mm/dd/yyyy)
User is considered inactive for any point on or before this date and will be flagged for bulk license changes
#### Restart Processing
If user interrups a bulk license change operation, user can restart based on the email address entered
#### Custom Attributes
Select a custom attribute pulled during the "Account Info" action and enter a value for a mass update of filtered users to get the attribute change



### Log Window

#### Log window
This is a list box that contains text of any action the program is performing on Zoom.  The contents will be automatically saved to a log file as it is updated (if that feature is enabled).  Selecting an item in the log window that contains the '@' symbol will populate the user email field below with that value.

#### Cancel Action
Will end any processing that is happening (i.e. retrieving all user Data, backing user settings,..) that may have long processing times.  Any data pulled to the point that the Cancel Action button was triggered will be saved or processed.

#### Clear Log
Will clear contents of log window, and if Save File is enabled will start an new timestamped log file.

#### Search Textbox
Enter characters/words to search for in Log list.  Will highlight all matched entries

#### Find Next
Will navigate to the next matching item listed in the Search Textbox.

#### Log config
This will bring up another window with options for what should be displayed in the log window.


### Status Bar
#### Progress Bar
Shows progress of any action that has long processing times



### User Configuration
#### User Email
User email address that is linked to the buttons in the User Configuration frame.  Must first trigger "Retrieve All User Data" button for this to work appropriately

#### Op Log
Button that will pull that last 300 operation log entries and see if there are any entries that match the user email.  Contents will be placed into the log window.

#### Signing Log
Button that will pull the last 300 sign in/sign out log entries and see if there are any entries that match the user email.  Contents will be placed into the log window.

#### Updated Email
If the user has a new email address (perhaps they had a name change), you can update their account to reflect their new email address.  Enter the user's new email address here.

#### Update
Button that will trigger updating the User Email to be changed to the Updated Email (currently this feature does not update the retrieved user data, so you will have to "Retrieve All User Data" again to be able to use the new email with the "User Email" field.

#### Info
Pulls info on User Email including:  number of cloud recordings, difference in settings to the group settings they may be in, last sign in, client version, number of meetings listed in zoom records, Zoom user ID, and a few other items.

#### Log Out
Will revoke the SSO Token for the user and in effect, log them out of all devices they are using Zoom with.

#### Licensed
Will assign user "Licensed" status in Zoom

#### Basic
Will assign user "Basic" status in Zoom

#### Webinar
Toggles to either assign or remove a webinar license for user

#### Large Mtg
Toggles to either assign or remove a Large Meeting license for user

#### Delete
Button to Delete user from Zoom account (enabled when the checkbox "Change user to Basic (No Deletes)" is disabled) 

# Previous Updates
## April 16th, 2021 Update
- Added ability to pull data using a different subaccount
- Preset "Execute" button is now functional and will trigger simple presets
- Fix with using PyJWT module update (will work with previous or latest version of PyJWT

## January 29th, 2021 Update
- Finish first release of opening CSV files with previous cloud recording metadata scans, since scans can take time, being able to open a previous scan can help reduce the amount of time needed to search for data

## January 27th, 2021 Update
- Fixes and improvements to last update along with a work in progress of opening CSV files of recording metadata.
## January 26th, 2021 Update
- Added ability to retrieve account cloud recording metadata and find cloud recordings if the user was a participant in the meeting.  This may take time to do if there are many cloud recordings on the account.  Directory creation isn't effective yet and button disabling will be needed based on sequence (scan metadata, find user in those meetings).

## November 24th, 2020 Update
- Allow custom attribute values to be set to group of users based on the filtering set in the Account actions page.  Minor update with Cloud storage readout to include overage amount on paid plans
- Updated Custom Attributes combo menu on Account Actions page to populate with values after triggering the Account Info button on the settings page. 
- Added account lock settings to be pulled and added into group settings file.  Also added timestamp to group settings file to be able to track changes over time.
- Working on custom API presets, still a work in progress so it is not fully functional nor does the gui have all the finalized features yet.

